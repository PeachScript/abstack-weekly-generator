!function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="dist",t(0)}([function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function r(e){u.innerHTML="",s=o["default"].init(u,e||d),clearInterval(f),f=c["default"].save(1,function(){return s.exportData()})}var i=n(1),o=a(i),l=n(2),c=a(l),d=[{head:"本周工作任务及完成情况",title:["工作任务描述","起止日期","完成率％","备注"],row:[]},{head:"下周安排",title:["工作任务描述","起止日期","备注"],row:[]},{head:"问题感言",title:["描述"],row:[]}],u=document.getElementById("table-container"),f=void 0,s=void 0;!function(){var e=void 0;try{e=JSON.parse(c["default"].load())}catch(t){throw t}r(e)}(),document.getElementById("button-copy-table").addEventListener("click",function(){c["default"].copyElement(document.getElementById("table-container"))}),document.getElementById("button-clear-data").addEventListener("click",function(){c["default"].confirm("数据清空后不可恢复，是否继续？")&&!function(){var e=c["default"].save(.001,function(){return clearInterval(e),""});r()}()})},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function r(){var e=document.getElementsByTagName("input")[0];return e?e.parentNode:e}function i(e){if(e){var t=e.parentNode;return t&&"TABLE"===t.tagName?t:i(t)}}function o(e){var t=document.createElement("tr"),n=i(e),a=n.getElementsByTagName("tr")[2].getElementsByTagName("td");n.appendChild(t),Array.prototype.forEach.call(a,function(){var e=document.createElement("td");c(e),t.appendChild(e)}),t.getElementsByTagName("td")[0].innerHTML=n.getElementsByTagName("tr").length-2,t.getElementsByTagName("td")[1].click()}function l(e){var t=e.parentNode,n=t.parentNode,a=t.parentNode.getElementsByTagName("tr").length;if(a>3){var r=g["default"].confirm("确认删除吗？");r&&t.parentNode.removeChild(t)}var i=n.getElementsByTagName("tr");Array.prototype.forEach.call(i,function(e,t){t>1&&(e.getElementsByTagName("td")[0].innerHTML=t-1)})}function c(e){e.addEventListener("click",function(t){var n=document.createElement("input"),a=t||event;if(a.target===e){var r=e.innerHTML;e.appendChild(n),n.value=r,n.focus(),g["default"].bind(n,"enter",function(e){e.preventDefault(),o(n)}),g["default"].bind(n,"tab",function(e){e.preventDefault(),d()}),g["default"].bind(n,"shift+tab",function(e){e.preventDefault(),u()}),g["default"].bind(n,"shift+backspace",function(t){t.preventDefault(),l(e)}),n.addEventListener("blur",function(){setTimeout(function(){e.innerHTML=n.value},1)})}})}function d(){var e=r();if(e)if(null===e.nextSibling){if(null!==e.parentNode.nextSibling){var t=e.parentNode.nextSibling.childNodes.item(1);t.click()}}else e.nextSibling.click()}function u(){var e=r();if(null===e.previousSibling.previousSibling)if(null===e.parentNode.previousSibling)e.click();else{var t=e.parentNode.previousSibling.lastChild;null===t?e.click():t.click()}else e.previousSibling.click()}function f(e){var t=[],n=e.getElementsByTagName("td");return Array.prototype.forEach.call(n,function(e,n){n>0&&(0!==e.getElementsByTagName("input").length?t.push(e.getElementsByTagName("input")[0].value):t.push(e.innerHTML))}),t}function s(e){var t=[],n=e.getElementsByTagName("tr");return Array.prototype.forEach.call(n,function(e){t.push(f(e))}),t.slice(2)}function m(e,t){var n=t,a=[],r=e.getElementsByTagName("table");return Array.prototype.forEach.call(r,function(e){a.push(s(e))}),n.forEach(function(e,t){e.row=a[t]}),JSON.stringify(n)}function p(e,t){if("string"==typeof t)try{var n=JSON.parse(t);h.init(e,n)}catch(a){throw new Error("Data is not support JSON.parse()!")}else h.init(e,t)}Object.defineProperty(t,"__esModule",{value:!0});var v=n(2),g=a(v),h={};h.init=function(e,t){if(!(t instanceof Array))throw new Error("Props is not array!");return t.forEach(function(t){var n=document.createElement("table"),a=t.title.length+1,r=document.createElement("tr"),i=document.createElement("td"),o=document.createElement("tr"),l=document.createElement("td");e.appendChild(n),i.className="table-header",i.setAttribute("colspan",a),i.innerHTML=t.head,n.appendChild(r),r.appendChild(i),n.appendChild(o),l.innerHTML="序号",l.className="table-title",o.appendChild(l),t.title.forEach(function(e){var t=document.createElement("td");t.className="table-title",t.innerHTML=e,o.appendChild(t)}),0===t.row.length?!function(){var e=document.createElement("tr"),a=document.createElement("td");n.appendChild(e),e.appendChild(a),t.title.forEach(function(){var t=document.createElement("td");e.appendChild(t),c(t)}),e.getElementsByTagName("td")[0].innerHTML="1"}():t.row.forEach(function(e,t){var a=document.createElement("tr"),r=document.createElement("td");r.innerHTML=t+1,n.appendChild(a),a.appendChild(r),e.forEach(function(e){var t=document.createElement("td");t.innerHTML=e,a.appendChild(t),c(t)})})}),{exportData:function(){return m(e,t)},importData:function(t){return p(e,t)}}},t["default"]=h},function(e,t){(function(e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={};if(n.bind=function(e,t,n){var a={shift:"shiftKey",tab:9,enter:13,backspace:8};e.bindKeys||(e.bindKeys={}),e.bindKeys[t]=function(e){var r=t.split("+"),i=e||window.event,o=!0,l=void 0,c=void 0;for(l in a)a.hasOwnProperty(l)&&(c=a[l],r.indexOf(l)>-1?"number"==typeof c&&c!==i.keyCode?o=!1:"string"!=typeof c||i[c]||(o=!1):"string"==typeof c&&i[c]&&(o=!1));o&&n&&n.call(void 0,i)},e.addEventListener("keydown",e.bindKeys[t])},n.unbind=function(e,t,n){e.bindKeys[t]&&(e.removeEventListener("keydown",e.bindKeys[t]),n&&n.call(void 0))},n.copyElement=function(e){var t=alert,n=null,a=document.getElementsByTagName("table"),r=document.createElement("tr");a[a.length-1].appendChild(r),window.getSelection().removeAllRanges(),n=document.createRange(),n.selectNodeContents(e),window.getSelection().addRange(n);try{var i=document.execCommand("copy");t("拷贝"+(i===!0?"成功":"失败"))}catch(o){t("不能拷贝")}a[a.length-1].removeChild(r),window.getSelection().removeAllRanges()},n.save=function(e,t){return setInterval(function(){localStorage.setItem("saves",t())},1e3*e)},n.load=function(){return localStorage.getItem("saves")},n.confirm=function(e){var t=confirm;return t(e)},e.utils)throw new Error("There has utils already, cannot export utils!");e.utils=n,t["default"]=n}).call(t,function(){return this}())}]);